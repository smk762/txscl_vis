<!DOCTYPE html>
<meta charset="utf-8">
<html>
<head>
<script src="https://code.highcharts.com/stock/highstock.js"></script>
<script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
<script src="https://code.highcharts.com/stock/modules/export-data.js"></script>
</head>
<body>

<script type="text/javascript">
jsonXY = "https://cryptogeology.com/csv/globalpt.json";
var jsonData = "";
var json = new XMLHttpRequest();
json.open('GET', jsonXY, true);
json.responseType = 'blob';
json.onload = function() {
    var reader = new FileReader();
    reader.readAsText(json.response);
    reader.onload =  function(e){
    	jsonData = e.target.result;
        jsonData = jsonData.substring(0,(jsonData.lastIndexOf(',')))+"]";
        jsonData = JSON.parse(jsonData);
        console.log(jsonData[1]['globalpt']);
    };
};
json.send();

// get json to valid


Highcharts.setOptions({
  global: {
    useUTC: false
  }
});


// Create the chart
Highcharts.stockChart('txscl_graph', {
  chart: {
    events: {
      load: function () {


        // set up the updating of the chart each second
        var series = this.series[0];
        setInterval(function () {
          var x = (new Date()).getTime(), // current time
            y = globalPT;
          series.addPoint([x, y], true, true);
        }, 1000);
      }
    }
  },

  rangeSelector: {
    buttons: [{
      count: 1,
      type: 'minute',
      text: '1M'
    }, {
      count: 5,
      type: 'minute',
      text: '5M'
    }, {
      type: 'all',
      text: 'All'
    }],
    inputEnabled: false,
    selected: 0
  },

  title: {
    text: 'Global Payments per second (60 second average)'
  },

  exporting: {
    enabled: false
  },

  series: [{
    name: 'liveData',
    data: (function () {
      // generate an array of random data


      var data = [],
        time = (new Date()).getTime(),
        i;

      for (i = -999; i <= 0; i += 1) {
        data.push([
          time + i * 1000,
          globalPT
        ]);
      }
      return data;
    }())
  }]
});




    function processData(json) {
        var allTextLines = (json).split(/\r\n|\n/);
        var lines = [];
        for (var i=0; i<allTextLines.length; i++) {
            var data = allTextLines[i].split(',');
                var tarr = [];
                for (var j=0; j<data.length; j++) {
                    tarr.push(data[j]);
                }
                lines.push(tarr);
        		console.log(tarr);
        }
    }

    function errorHandler(evt) {
      if(evt.target.error.name == "NotReadableError") {
          alert("Canno't read file !");
      }
    }

    processData(jsonData);

</script>
<div id="txscl_graph" style="height: 400px; min-width: 310px"></div>
</body>
</html>